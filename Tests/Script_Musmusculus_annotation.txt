#####################
#
#Igenome was downloaded, fasta file was modified in order to have Chr1 and not only 1.
#The bowtie2 and hisat2 indexes were build under with this new references.
#Note:It is important to have the Mt and Pt (additional chromosomes)
#
#Annotation file was downloaded from http://gramene.org/ and modified with the following script
#in order to have the rRNA, tRNA and additional chromosomes excluded by RepOthers-ome
#
#####################

wget ftp://ftp.gramene.org/pub/gramene/release-58/gtf/zea_mays/Zea_mays.AGPv4.40.chr.gtf.gz
gunzip Zea_mays.AGPv4.40.chr.gtf.gz
grep -v '#' Zea_mays.AGPv4.40.chr.gtf |awk -F "\t" '{$1= "chr"$1;print$0;}' OFS="\t" > Zea_mays.AGPv4_mod.40.chr.gtf 
grep -P "\tgene\t.+(biotype.+rRNA|biotype.+tRNA)" Zea_mays.AGPv4_mod.40.chr.gtf > Zmay_rtM_RNA.gtf

wget ftp://ftp.gramene.org/pub/gramene/release-58/gff3/zea_mays/Zea_mays.AGPv4.40.chr.gff3.gz
gunzip Zea_mays.AGPv4.40.chr.gff3.gz
grep -v '#' Zea_mays.AGPv4.40.chr.gff3 |awk -F "\t" '{$1= "chr"$1;print$0;}' OFS="\t" > Zea_mays.AGPv4_mod.40.chr.gff3
grep -P '\tchromosome\t' Zea_mays.AGPv4_mod.40.chr.gff3 | grep -Pv 'chr\d+|chrX|chrY' >> Zmay_rtM_RNA.gtf

awk -F "\t" '{print $1,$4,$5,$9,$7}' OFS="\t" Zmay_rtM_RNA.gtf >Zmay_rtM_RNA.bed

rm Zea_mays.AGPv4_mod.40.chr.gff3 Zea_mays.AGPv4.40.chr.gff3 Zea_mays.AGPv4.40.chr.gtf 
